
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Project 3</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

</head>

<body>
  <div class="container">
    <div class="row">
      <div class="col-md-12 p-5 text-center bg-light">
        <h1>Electric Charging Stations in the US</h1>
        <p>Let's explore the dataset</p>
        <img src="{{ url_for('static', filename='htmlimages/statp.jpg') }}" alt="Statp" style="width: 300px; height: 200px;">
      </div>
    </div>
    <div style="width: 25%; margin-bottom: 10px; margin-left: auto; margin-right: auto;">
      <a href="/" style="display: block; width: 100%; text-align: center; padding: 6px 12px; background-color: #007bff; color: white; text-decoration: none; margin-bottom: 5px;">Go Home</a>
  </div>
  <div class="container">
    <div class="row">
      <div class="col-md-12 text-center">
        <h2>Station Data Charts</h2>
      </div>
    </div>
  
    <div style="width: 100%; max-width: 1000px; margin: auto; text-align: left;">
      <h3>Stations by State</h3>
      <canvas id="statesChart"></canvas>
    </div>
    
    <div style="width: 100%; max-width: 1000px; margin: auto; text-align: left;">
      <h3>Top 50 Cities by Stations</h3>
      <canvas id="citiesChart" style="height: 1500px;"></canvas>
    </div>
    
    <div style="width: 100%; max-width: 600px; margin: auto; text-align: left;">
      <h3>Stations by Region</h3>
      <canvas id="regionsChart"></canvas>
    </div>
  </div>
  
  <script>
    // passing data from flask into html with json
    var statesData = {{ states_data | tojson }};
    var citiesData = {{ cities_data | tojson }};
    var regionsData = {{ regions_data | tojson }}; 
    
    // States Chart
    statesData.sort((a, b) => a.state.localeCompare(b.state));
var statesChart = new Chart(document.getElementById('statesChart'), {
  type: 'bar',
  data: {
    labels: statesData.map(data => data.state),
    datasets: [{
      label: 'Stations by State',
      data: statesData.map(data => data.count),
      backgroundColor: 'rgba(214, 40, 40, 0.6)'
    }]
  },
  options: {
    responsive: true,
    scales: {
      y: {
        beginAtZero: true
      }
    },
    plugins: {
      legend: {
        display: false
      }
    }
  }
});
    
// Cities Chart
var citiesDataLength = citiesData.length;
var barHeight = 13; 
var chartHeight = citiesDataLength * barHeight; 
document.getElementById('citiesChart').height = chartHeight;

var citiesChartCtx = document.getElementById('citiesChart').getContext('2d');
new Chart(citiesChartCtx, {
  type: 'bar',
  data: {
    labels: citiesData.map(data => data.city),
    datasets: [{
      label: 'Top 50 Cities by Stations',
      data: citiesData.map(data => data.count),
      backgroundColor: 'rgba(0, 78, 146, 0.6)',
    }]
  },
  options: {
    responsive: true,
    scales: {
      x: {
        beginAtZero: true
      },
      y: {
        beginAtZero: true,
        ticks: {
          autoSkip: false
        }
      }
    },
    indexAxis: 'y',
    plugins: {
    legend: {
      display: false
    }
  }
  }
});

    // Regions Chart
    var regionsChartCtx = document.getElementById('regionsChart').getContext('2d');
    new Chart(regionsChartCtx, {
      type: 'pie',
      data: {
        labels: regionsData.map(data => data.region),
        datasets: [{
          label: 'Stations by Region',
          data: regionsData.map(data => data.count),
          backgroundColor: [
        'rgba(214, 40, 40, 0.6)',
        'rgba(0, 78, 146, 0.6)',
        'rgba(192, 192, 192, 0.6)',
        'rgba(244, 208, 63, 0.6)',
      ],
      borderColor: 'rgba(255,255,255,1)',
      borderWidth: 2
    }]
      },
      options: {
    responsive: true,
    indexAxis: 'y', // For a horizontal bar chart
  }
    });
  </script>

</div>
</body>

</html>